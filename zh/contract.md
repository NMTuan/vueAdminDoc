# 接口约定

> [!tip] 注意：
>
> vueAdmin 是一个约定式的程序，可能无法直接融入你的项目。需要你依照约定修改现有 api，或单独开发一套 api。

## 标准格式

所有接口统一按照以下格式返回数据：

```json
{
    code: 200,
    message: "",
    data: {}
}
```

| 字段    | 数据类型 | 含义                                                       |
| --------- | ---------- | ------------------------------------------------------------ |
| code    | number   | 状态码，正常为200，其它请自定义。                          |
| message | string   | 状态消息，留空时页面无动作；如有内容，会在右上角弹出内容。 |
| data    | object   | 数据主体，各接口返回的实际数据内容。                       |

目前, 这个格式还是固定的. 未来会根据实际情况增加可变方式.

## 登录

接口地址: `/auth/login`

这里使用了标准的 `jwt` 鉴权模式.

登录页面会以 POST 方式提交以下数据到接口

| 字段     | 数据类型 | 描述                                                                                       |
| ---------- | ---------- | -------------------------------------------------------------------------------------------- |
| username | string   | 登录账号                                                                                   |
| password | string   | 登录密码                                                                                   |
| remember | boolean  | 是否长时间登录, 注意: 前端对此项没有做任何处理, 需后端根据提交的值返回不同过期时间的 token |

接口需按照标准格式返回 token 信息, 如下:

```json
{ 
	code: 200, 
	message: "", 
	data: {
		token: "the token string"
	}
}
```

## 登出

接口地址: `/auth/logout`

目前程序没有请求任何接口, 仅仅是清除了本地 token 并跳转至登录页面.


## 用户信息

接口地址: `/auth/info`

这个接口是整个 vueAdmin 的核心, 当用户登录成功 或 浏览器首次访问平台时, vueAdmin 会携带 token 向此接口 发起 GET 请求, 获取当前用户的功能菜单及权限. 该接口需按以下格式返回:

```json
{ code: 200, message: '', data: {
	site: {	// 站点信息
		title: '',	// 页面左上角显示的标题
		logo: ''	// 页面左上角显示的logo路径, 没有则不显示. 注意尺寸, 前端未控制图片尺寸.
	},
	menu: [],	// 页面左侧的功能菜单, 详见下文
	topbar: [],	// 页面右上角功能菜单, 详见下文
}}
```

### menu

menu 是当前用户菜单及功能权限的体现, 定义为一个无限层级的数组, 基本格式如下:

```json
[
	{
		label: "首页",	// 此功能在菜单显示的内容
		key: "index",	// 唯一id
		icon: "ri-home-line",	// 图标, 没有则不显示. 支持完整的 remixIcon 图标命名.
		component: "index",	// 此功能所使用的组件, 留空则渲染 Blank 组件.
		children: []	// 子集
	},
]
```

### topbar

topbar 用来定义页面右上角的功能菜单, 常用于快捷操作/消息/用户菜单等操作. 基本格式如下:

```json
[
	{
		label: "站点设置",	// 菜单名称
		to: "/site/config",	// 点击后跳转地址
		image: "",	// 图片地址, 没有则不显示
		icon: "ri-tools-line",	// 图标, 没有则不显示
		activeIcon: "",	// 激活后的图标, 部分组件可设置, 如 fullScreen darkMode
		component: ""	// 组件名称, 内置一些组件, 详见下文
	},
	'fullScreen'	// 简写
]
```

目前已实现组件如下:

| 组件名称   | 描述                                           | 简写为string |
| ------------ | ------------------------------------------------ | -------------- |
| dropdown   | 下拉菜单, 子菜单的key为`dropdown`, value为基本格式的数组 |              |
| fullScreen | 切换全屏的按钮                                | ✔           |
| darkMode   | 切换黑暗模式的按钮 (黑暗模式的样式未适配)      | ✔           |
| i18n       | 切换多语言的下拉菜单 (未完成)                  | ✔           |

*简写为string: 如无其它配置时, 可将当前object对象简写为一个string*